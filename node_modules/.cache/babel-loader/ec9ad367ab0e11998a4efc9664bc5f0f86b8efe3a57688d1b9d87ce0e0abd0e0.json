{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n0 && (module.exports = {\n  resolveImages: null,\n  resolveOpenGraph: null,\n  resolveTwitter: null\n});\nfunction _export(target, all) {\n  for (var name in all) Object.defineProperty(target, name, {\n    enumerable: true,\n    get: all[name]\n  });\n}\n_export(exports, {\n  resolveImages: function () {\n    return resolveImages;\n  },\n  resolveOpenGraph: function () {\n    return resolveOpenGraph;\n  },\n  resolveTwitter: function () {\n    return resolveTwitter;\n  }\n});\nconst _utils = require(\"../generate/utils\");\nconst _resolveurl = require(\"./resolve-url\");\nconst _resolvetitle = require(\"./resolve-title\");\nconst OgTypeFields = {\n  article: [\"authors\", \"tags\"],\n  song: [\"albums\", \"musicians\"],\n  playlist: [\"albums\", \"musicians\"],\n  radio: [\"creators\"],\n  video: [\"actors\", \"directors\", \"writers\", \"tags\"],\n  basic: [\"emails\", \"phoneNumbers\", \"faxNumbers\", \"alternateLocale\", \"audio\", \"videos\"]\n};\nfunction resolveImages(images, metadataBase) {\n  const resolvedImages = (0, _utils.resolveAsArrayOrUndefined)(images);\n  if (!resolvedImages) return resolvedImages;\n  const nonNullableImages = [];\n  for (const item of resolvedImages) {\n    if (!item) continue;\n    const isItemUrl = (0, _resolveurl.isStringOrURL)(item);\n    const inputUrl = isItemUrl ? item : item.url;\n    if (!inputUrl) continue;\n    nonNullableImages.push(isItemUrl ? {\n      url: (0, _resolveurl.resolveUrl)(item, metadataBase)\n    } : {\n      ...item,\n      // Update image descriptor url\n      url: (0, _resolveurl.resolveUrl)(item.url, metadataBase)\n    });\n  }\n  return nonNullableImages;\n}\nfunction getFieldsByOgType(ogType) {\n  switch (ogType) {\n    case \"article\":\n    case \"book\":\n      return OgTypeFields.article;\n    case \"music.song\":\n    case \"music.album\":\n      return OgTypeFields.song;\n    case \"music.playlist\":\n      return OgTypeFields.playlist;\n    case \"music.radio_station\":\n      return OgTypeFields.radio;\n    case \"video.movie\":\n    case \"video.episode\":\n      return OgTypeFields.video;\n    default:\n      return OgTypeFields.basic;\n  }\n}\nconst resolveOpenGraph = (openGraph, metadataBase, {\n  pathname\n}, titleTemplate) => {\n  if (!openGraph) return null;\n  function resolveProps(target, og) {\n    const ogType = og && \"type\" in og ? og.type : undefined;\n    const keys = getFieldsByOgType(ogType);\n    for (const k of keys) {\n      const key = k;\n      if (key in og && key !== \"url\") {\n        const value = og[key];\n        if (value) {\n          const arrayValue = (0, _utils.resolveAsArrayOrUndefined)(value);\n          target[key] = arrayValue;\n        }\n      }\n    }\n    const imageMetadataBase = (0, _resolveurl.getSocialImageFallbackMetadataBase)(metadataBase);\n    target.images = resolveImages(og.images, imageMetadataBase);\n  }\n  const resolved = {\n    ...openGraph,\n    title: (0, _resolvetitle.resolveTitle)(openGraph.title, titleTemplate)\n  };\n  resolveProps(resolved, openGraph);\n  resolved.url = openGraph.url ? (0, _resolveurl.resolveAbsoluteUrlWithPathname)(openGraph.url, metadataBase, pathname) : null;\n  return resolved;\n};\nconst TwitterBasicInfoKeys = [\"site\", \"siteId\", \"creator\", \"creatorId\", \"description\"];\nconst resolveTwitter = (twitter, metadataBase, titleTemplate) => {\n  var _resolved_images;\n  if (!twitter) return null;\n  let card = \"card\" in twitter ? twitter.card : undefined;\n  const resolved = {\n    ...twitter,\n    title: (0, _resolvetitle.resolveTitle)(twitter.title, titleTemplate)\n  };\n  for (const infoKey of TwitterBasicInfoKeys) {\n    resolved[infoKey] = twitter[infoKey] || null;\n  }\n  const imageMetadataBase = (0, _resolveurl.getSocialImageFallbackMetadataBase)(metadataBase);\n  resolved.images = resolveImages(twitter.images, imageMetadataBase);\n  card = card || (((_resolved_images = resolved.images) == null ? void 0 : _resolved_images.length) ? \"summary_large_image\" : \"summary\");\n  resolved.card = card;\n  if (\"card\" in resolved) {\n    switch (resolved.card) {\n      case \"player\":\n        {\n          resolved.players = (0, _utils.resolveAsArrayOrUndefined)(resolved.players) || [];\n          break;\n        }\n      case \"app\":\n        {\n          resolved.app = resolved.app || {};\n          break;\n        }\n      default:\n        break;\n    }\n  }\n  return resolved;\n};","map":{"version":3,"names":["resolveImages","resolveOpenGraph","resolveTwitter","OgTypeFields","article","song","playlist","radio","video","basic","images","metadataBase","resolvedImages","_utils","resolveAsArrayOrUndefined","nonNullableImages","item","isItemUrl","_resolveurl","isStringOrURL","inputUrl","url","push","resolveUrl","getFieldsByOgType","ogType","openGraph","pathname","titleTemplate","resolveProps","target","og","type","undefined","keys","k","key","value","arrayValue","imageMetadataBase","getSocialImageFallbackMetadataBase","resolved","title","_resolvetitle","resolveTitle","resolveAbsoluteUrlWithPathname","TwitterBasicInfoKeys","twitter","_resolved_images","card","infoKey","length","players","app"],"sources":["../../../../src/lib/metadata/resolvers/resolve-opengraph.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}