{"ast":null,"code":"// This file should be imported before any others. It sets up the environment\n// for later imports to work properly.\n// expose AsyncLocalStorage on global for react usage if it isn't already provided by the environment\n\"use strict\";\n\nif (typeof globalThis.AsyncLocalStorage !== \"function\") {\n  const {\n    AsyncLocalStorage\n  } = require(\"async_hooks\");\n  globalThis.AsyncLocalStorage = AsyncLocalStorage;\n}\nif (typeof globalThis.WebSocket !== \"function\") {\n  Object.defineProperty(globalThis, \"WebSocket\", {\n    get() {\n      return require(\"next/dist/compiled/ws\").WebSocket;\n    }\n  });\n}\n// This adds a `Promise.withResolvers` polyfill. This will soon be adopted into\n// the spec.\n//\n// TODO: remove this polyfill when it is adopted into the spec.\n//\n// https://tc39.es/proposal-promise-with-resolvers/\n//\nif (!(\"withResolvers\" in Promise) || typeof Promise.withResolvers !== \"function\") {\n  Promise.withResolvers = () => {\n    let resolvers;\n    // Create the promise and assign the resolvers to the object.\n    const promise = new Promise((resolve, reject) => {\n      resolvers = {\n        resolve,\n        reject\n      };\n    });\n    // We know that resolvers is defined because the Promise constructor runs\n    // synchronously.\n    return {\n      promise,\n      resolve: resolvers.resolve,\n      reject: resolvers.reject\n    };\n  };\n}","map":{"version":3,"names":["globalThis","AsyncLocalStorage","require","WebSocket","Object","defineProperty","get","Promise","withResolvers","resolvers","promise","resolve","reject"],"sources":["../../src/server/node-environment.ts"],"sourcesContent":[null],"mappings":"AAAA;AACA;AAEA;;;AACA,IAAI,OAAOA,UAAC,CAAmBC,iBAAiB,KAAK,YAAY;EAC/D,MAAM;IAAEA;EAAiB,CAAE,GAAGC,OAAA,CAAQ;EACpCF,UAAA,CAAmBC,iBAAiB,GAAGA,iBAAA;AAC3C;AAEA,IAAI,OAAOD,UAAC,CAAmBG,SAAS,KAAK,YAAY;EACvDC,MAAA,CAAOC,cAAc,CAACL,UAAA,EAAY,aAAa;IAC7CM,IAAA;MACE,OAAOJ,OAAA,CAAQ,yBAAyBC,SAAS;IACnD;EACF;AACF;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IACE,EAAE,mBAAmBI,OAAM,KAC3B,OAAOA,OAAA,CAAQC,aAAa,KAAK,YACjC;EACAD,OAAA,CAAQC,aAAa,GAAG;IACtB,IAAIC,SAAA;IAKJ;IACA,MAAMC,OAAA,GAAU,IAAIH,OAAA,CAAW,CAACI,OAAA,EAASC,MAAA;MACvCH,SAAA,GAAY;QAAEE,OAAA;QAASC;MAAO;IAChC;IAEA;IACA;IACA,OAAO;MAAEF,OAAA;MAASC,OAAA,EAASF,SAAA,CAAWE,OAAO;MAAEC,MAAA,EAAQH,SAAA,CAAWG;IAAO;EAC3E;AACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}