{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"loadStaticPaths\", {\n  enumerable: true,\n  get: function () {\n    return loadStaticPaths;\n  }\n});\nrequire(\"../require-hook\");\nrequire(\"../node-polyfill-fetch\");\nrequire(\"../node-environment\");\nconst _utils = require(\"../../build/utils\");\nconst _loadcomponents = require(\"../load-components\");\nconst _setuphttpagentenv = require(\"../setup-http-agent-env\");\nconst _hooksservercontext = /*#__PURE__*/_interop_require_wildcard(require(\"../../client/components/hooks-server-context\"));\nconst _staticgenerationasyncstorageexternal = require(\"../../client/components/static-generation-async-storage.external\");\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n  var cache = _getRequireWildcardCache(nodeInterop);\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj.default = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\nconst {\n  AppRouteRouteModule\n} = require(\"../future/route-modules/app-route/module.compiled\");\nasync function loadStaticPaths({\n  distDir,\n  pathname,\n  config,\n  httpAgentOptions,\n  locales,\n  defaultLocale,\n  isAppPath,\n  page,\n  isrFlushToDisk,\n  fetchCacheKeyPrefix,\n  maxMemoryCacheSize,\n  requestHeaders,\n  incrementalCacheHandlerPath\n}) {\n  // update work memory runtime-config\n  require(\"../../shared/lib/runtime-config.external\").setConfig(config);\n  (0, _setuphttpagentenv.setHttpClientAndAgentOptions)({\n    httpAgentOptions\n  });\n  const components = await (0, _loadcomponents.loadComponents)({\n    distDir,\n    // In `pages/`, the page is the same as the pathname.\n    page: page || pathname,\n    isAppPath\n  });\n  if (!components.getStaticPaths && !isAppPath) {\n    // we shouldn't get to this point since the worker should\n    // only be called for SSG pages with getStaticPaths\n    throw new Error(`Invariant: failed to load page with getStaticPaths for ${pathname}`);\n  }\n  if (isAppPath) {\n    const {\n      routeModule\n    } = components;\n    const generateParams = routeModule && AppRouteRouteModule.is(routeModule) ? [{\n      config: {\n        revalidate: routeModule.userland.revalidate,\n        dynamic: routeModule.userland.dynamic,\n        dynamicParams: routeModule.userland.dynamicParams\n      },\n      generateStaticParams: routeModule.userland.generateStaticParams,\n      segmentPath: pathname\n    }] : await (0, _utils.collectGenerateParams)(components.ComponentMod.tree);\n    return await (0, _utils.buildAppStaticPaths)({\n      page: pathname,\n      generateParams,\n      configFileName: config.configFileName,\n      distDir,\n      requestHeaders,\n      incrementalCacheHandlerPath,\n      serverHooks: _hooksservercontext,\n      staticGenerationAsyncStorage: _staticgenerationasyncstorageexternal.staticGenerationAsyncStorage,\n      isrFlushToDisk,\n      fetchCacheKeyPrefix,\n      maxMemoryCacheSize\n    });\n  }\n  return await (0, _utils.buildStaticPaths)({\n    page: pathname,\n    getStaticPaths: components.getStaticPaths,\n    configFileName: config.configFileName,\n    locales,\n    defaultLocale\n  });\n}","map":{"version":3,"names":["loadStaticPaths","AppRouteRouteModule","require","distDir","pathname","config","httpAgentOptions","locales","defaultLocale","isAppPath","page","isrFlushToDisk","fetchCacheKeyPrefix","maxMemoryCacheSize","requestHeaders","incrementalCacheHandlerPath","setConfig","_setuphttpagentenv","setHttpClientAndAgentOptions","components","_loadcomponents","loadComponents","getStaticPaths","Error","routeModule","generateParams","is","revalidate","userland","dynamic","dynamicParams","generateStaticParams","segmentPath","_utils","collectGenerateParams","ComponentMod","tree","buildAppStaticPaths","configFileName","serverHooks","_hooksservercontext","staticGenerationAsyncStorage","_staticgenerationasyncstorageexternal","buildStaticPaths"],"sources":["../../../src/server/dev/static-paths-worker.ts"],"sourcesContent":[null],"mappings":";;;;;+BA0BsB;;;WAAAA,eAAA;;;QAxBf;QACA;QACA;uBAOA;gCACwB;mCACc;2EAEhB;sDACgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE7C,MAAM;EAAEC;AAAmB,CAAE,GAC3BC,OAAA,CAAQ;AAOH,eAAeF,gBAAgB;EACpCG,OAAO;EACPC,QAAQ;EACRC,MAAM;EACNC,gBAAgB;EAChBC,OAAO;EACPC,aAAa;EACbC,SAAS;EACTC,IAAI;EACJC,cAAc;EACdC,mBAAmB;EACnBC,kBAAkB;EAClBC,cAAc;EACdC;AAA2B,CAe5B;EAKC;EACAb,OAAA,CAAQ,4CAA4Cc,SAAS,CAACX,MAAA;EAC9D,IAAAY,kBAAA,CAAAC,4BAA4B,EAAC;IAC3BZ;EACF;EAEA,MAAMa,UAAA,GAAa,MAAM,IAAAC,eAAA,CAAAC,cAAc,EAAC;IACtClB,OAAA;IACA;IACAO,IAAA,EAAMA,IAAA,IAAQN,QAAA;IACdK;EACF;EAEA,IAAI,CAACU,UAAA,CAAWG,cAAc,IAAI,CAACb,SAAA,EAAW;IAC5C;IACA;IACA,MAAM,IAAIc,KAAA,CACP,0DAAyDnB,QAAS,EAAC;EAExE;EAEA,IAAIK,SAAA,EAAW;IACb,MAAM;MAAEe;IAAW,CAAE,GAAGL,UAAA;IACxB,MAAMM,cAAA,GACJD,WAAA,IAAevB,mBAAA,CAAoByB,EAAE,CAACF,WAAA,IAClC,CACE;MACEnB,MAAA,EAAQ;QACNsB,UAAA,EAAYH,WAAA,CAAYI,QAAQ,CAACD,UAAU;QAC3CE,OAAA,EAASL,WAAA,CAAYI,QAAQ,CAACC,OAAO;QACrCC,aAAA,EAAeN,WAAA,CAAYI,QAAQ,CAACE;MACtC;MACAC,oBAAA,EAAsBP,WAAA,CAAYI,QAAQ,CAACG,oBAAoB;MAC/DC,WAAA,EAAa5B;IACf,EACD,GACD,MAAM,IAAA6B,MAAA,CAAAC,qBAAqB,EAACf,UAAA,CAAWgB,YAAY,CAACC,IAAI;IAE9D,OAAO,MAAM,IAAAH,MAAA,CAAAI,mBAAmB,EAAC;MAC/B3B,IAAA,EAAMN,QAAA;MACNqB,cAAA;MACAa,cAAA,EAAgBjC,MAAA,CAAOiC,cAAc;MACrCnC,OAAA;MACAW,cAAA;MACAC,2BAAA;MACAwB,WAAA,EAAAC,mBAAA;MACAC,4BAAA,EAAAC,qCAAA,CAAAD,4BAA4B;MAC5B9B,cAAA;MACAC,mBAAA;MACAC;IACF;EACF;EAEA,OAAO,MAAM,IAAAoB,MAAA,CAAAU,gBAAgB,EAAC;IAC5BjC,IAAA,EAAMN,QAAA;IACNkB,cAAA,EAAgBH,UAAA,CAAWG,cAAc;IACzCgB,cAAA,EAAgBjC,MAAA,CAAOiC,cAAc;IACrC/B,OAAA;IACAC;EACF;AACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}