{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"createServerComponentRenderer\", {\n  enumerable: true,\n  get: function () {\n    return createServerComponentRenderer;\n  }\n});\nconst _react = /*#__PURE__*/_interop_require_wildcard(require(\"react\"));\nconst _useflightresponse = require(\"./use-flight-response\");\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n  var cache = _getRequireWildcardCache(nodeInterop);\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj.default = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\nfunction createServerComponentRenderer(ComponentToRender, ComponentMod, {\n  transformStream,\n  clientReferenceManifest,\n  serverContexts,\n  rscChunks\n}, serverComponentsErrorHandler, nonce) {\n  let RSCStream;\n  const createRSCStream = props => {\n    if (!RSCStream) {\n      RSCStream = ComponentMod.renderToReadableStream( /*#__PURE__*/_react.default.createElement(ComponentToRender, props), clientReferenceManifest.clientModules, {\n        context: serverContexts,\n        onError: serverComponentsErrorHandler\n      });\n    }\n    return RSCStream;\n  };\n  const flightResponseRef = {\n    current: null\n  };\n  const writable = transformStream.writable;\n  return function ServerComponentWrapper(props) {\n    const reqStream = createRSCStream(props);\n    const response = (0, _useflightresponse.useFlightResponse)(writable, reqStream, clientReferenceManifest, rscChunks, flightResponseRef, nonce);\n    return (0, _react.use)(response);\n  };\n}","map":{"version":3,"names":["createServerComponentRenderer","ComponentToRender","ComponentMod","transformStream","clientReferenceManifest","serverContexts","rscChunks","serverComponentsErrorHandler","nonce","RSCStream","createRSCStream","props","renderToReadableStream","_react","default","createElement","clientModules","context","onError","flightResponseRef","current","writable","ServerComponentWrapper","reqStream","response","_useflightresponse","useFlightResponse","use"],"sources":["../../../src/server/app-render/create-server-components-renderer.tsx"],"sourcesContent":[null],"mappings":";;;;;+BAWgB;;;WAAAA,6BAAA;;;8DARW;mCAEO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM3B,SAASA,8BACdC,iBAAwC,EACxCC,YAMC,EACD;EACEC,eAAe;EACfC,uBAAuB;EACvBC,cAAc;EACdC;AAAS,CAQV,EACDC,4BAAmE,EACnEC,KAAc;EAEd,IAAIC,SAAA;EACJ,MAAMC,eAAA,GAAmBC,KAAA;IACvB,IAAI,CAACF,SAAA,EAAW;MACdA,SAAA,GAAYP,YAAA,CAAaU,sBAAsB,eAC7CC,MAAA,CAAAC,OAAA,CAAAC,aAAA,CAACd,iBAAA,EAAuBU,KAAA,GACxBP,uBAAA,CAAwBY,aAAa,EACrC;QACEC,OAAA,EAASZ,cAAA;QACTa,OAAA,EAASX;MACX;IAEJ;IACA,OAAOE,SAAA;EACT;EAEA,MAAMU,iBAAA,GAAuC;IAAEC,OAAA,EAAS;EAAK;EAE7D,MAAMC,QAAA,GAAWlB,eAAA,CAAgBkB,QAAQ;EACzC,OAAO,SAASC,uBAAuBX,KAAY;IACjD,MAAMY,SAAA,GAAYb,eAAA,CAAgBC,KAAA;IAClC,MAAMa,QAAA,GAAW,IAAAC,kBAAA,CAAAC,iBAAiB,EAChCL,QAAA,EACAE,SAAA,EACAnB,uBAAA,EACAE,SAAA,EACAa,iBAAA,EACAX,KAAA;IAEF,OAAO,IAAAK,MAAA,CAAAc,GAAG,EAACH,QAAA;EACb;AACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}