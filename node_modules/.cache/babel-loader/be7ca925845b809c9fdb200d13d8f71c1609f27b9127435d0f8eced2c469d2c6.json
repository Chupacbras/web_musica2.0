{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"eventNextPlugins\", {\n  enumerable: true,\n  get: function () {\n    return eventNextPlugins;\n  }\n});\nconst _findup = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/find-up\"));\nfunction _interop_require_default(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nconst EVENT_PLUGIN_PRESENT = \"NEXT_PACKAGE_DETECTED\";\nasync function eventNextPlugins(dir) {\n  try {\n    const packageJsonPath = await (0, _findup.default)(\"package.json\", {\n      cwd: dir\n    });\n    if (!packageJsonPath) {\n      return [];\n    }\n    const {\n      dependencies = {},\n      devDependencies = {}\n    } = require(packageJsonPath);\n    const deps = {\n      ...devDependencies,\n      ...dependencies\n    };\n    return Object.keys(deps).reduce((events, plugin) => {\n      const version = deps[plugin];\n      // Don't add deps without a version set\n      if (!version) {\n        return events;\n      }\n      events.push({\n        eventName: EVENT_PLUGIN_PRESENT,\n        payload: {\n          packageName: plugin,\n          packageVersion: version\n        }\n      });\n      return events;\n    }, []);\n  } catch (_) {\n    return [];\n  }\n}","map":{"version":3,"names":["eventNextPlugins","EVENT_PLUGIN_PRESENT","dir","packageJsonPath","_findup","default","cwd","dependencies","devDependencies","require","deps","Object","keys","reduce","events","plugin","version","push","eventName","payload","packageName","packageVersion","_"],"sources":["../../../src/telemetry/events/plugins.ts"],"sourcesContent":[null],"mappings":";;;;;+BAWsB;;;WAAAA,gBAAA;;;8DAXH;;;;;;AAEnB,MAAMC,oBAAA,GAAuB;AAStB,eAAeD,iBACpBE,GAAW;EAEX,IAAI;IACF,MAAMC,eAAA,GAAkB,MAAM,IAAAC,OAAA,CAAAC,OAAM,EAAC,gBAAgB;MAAEC,GAAA,EAAKJ;IAAI;IAChE,IAAI,CAACC,eAAA,EAAiB;MACpB,OAAO,EAAE;IACX;IAEA,MAAM;MAAEI,YAAA,GAAe,CAAC,CAAC;MAAEC,eAAA,GAAkB,CAAC;IAAC,CAAE,GAAGC,OAAA,CAAQN,eAAA;IAE5D,MAAMO,IAAA,GAAO;MAAE,GAAGF,eAAe;MAAE,GAAGD;IAAa;IAEnD,OAAOI,MAAA,CAAOC,IAAI,CAACF,IAAA,EAAMG,MAAM,CAC7B,CAACC,MAAA,EAA4BC,MAAA;MAC3B,MAAMC,OAAA,GAAUN,IAAI,CAACK,MAAA,CAAO;MAC5B;MACA,IAAI,CAACC,OAAA,EAAS;QACZ,OAAOF,MAAA;MACT;MAEAA,MAAA,CAAOG,IAAI,CAAC;QACVC,SAAA,EAAWjB,oBAAA;QACXkB,OAAA,EAAS;UACPC,WAAA,EAAaL,MAAA;UACbM,cAAA,EAAgBL;QAClB;MACF;MAEA,OAAOF,MAAA;IACT,GACA,EAAE;EAEN,EAAE,OAAOQ,CAAA,EAAG;IACV,OAAO,EAAE;EACX;AACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}