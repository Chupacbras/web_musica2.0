{"ast":null,"code":"/*\n * Partially adapted from @babel/core (MIT license).\n */\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"default\", {\n  enumerable: true,\n  get: function () {\n    return transform;\n  }\n});\nconst _traverse = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/traverse\"));\nconst _generator = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/generator\"));\nconst _corelibnormalizefile = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/core-lib-normalize-file\"));\nconst _corelibnormalizeopts = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/core-lib-normalize-opts\"));\nconst _corelibblockhoistplugin = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/core-lib-block-hoist-plugin\"));\nconst _corelibpluginpass = /*#__PURE__*/_interop_require_default(require(\"next/dist/compiled/babel/core-lib-plugin-pass\"));\nconst _getconfig = /*#__PURE__*/_interop_require_default(require(\"./get-config\"));\nconst _util = require(\"./util\");\nfunction _interop_require_default(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction getTraversalParams(file, pluginPairs) {\n  const passPairs = [];\n  const passes = [];\n  const visitors = [];\n  for (const plugin of pluginPairs.concat((0, _corelibblockhoistplugin.default)())) {\n    const pass = new _corelibpluginpass.default(file, plugin.key, plugin.options);\n    passPairs.push([plugin, pass]);\n    passes.push(pass);\n    visitors.push(plugin.visitor);\n  }\n  return {\n    passPairs,\n    passes,\n    visitors\n  };\n}\nfunction invokePluginPre(file, passPairs) {\n  for (const [{\n    pre\n  }, pass] of passPairs) {\n    if (pre) {\n      pre.call(pass, file);\n    }\n  }\n}\nfunction invokePluginPost(file, passPairs) {\n  for (const [{\n    post\n  }, pass] of passPairs) {\n    if (post) {\n      post.call(pass, file);\n    }\n  }\n}\nfunction transformAstPass(file, pluginPairs, parentSpan) {\n  const {\n    passPairs,\n    passes,\n    visitors\n  } = getTraversalParams(file, pluginPairs);\n  invokePluginPre(file, passPairs);\n  const visitor = _traverse.default.visitors.merge(visitors, passes,\n  // @ts-ignore - the exported types are incorrect here\n  file.opts.wrapPluginVisitorMethod);\n  parentSpan.traceChild(\"babel-turbo-traverse\").traceFn(() => (0, _traverse.default)(file.ast, visitor, file.scope));\n  invokePluginPost(file, passPairs);\n}\nfunction transformAst(file, babelConfig, parentSpan) {\n  for (const pluginPairs of babelConfig.passes) {\n    transformAstPass(file, pluginPairs, parentSpan);\n  }\n}\nfunction transform(source, inputSourceMap, loaderOptions, filename, target, parentSpan) {\n  const getConfigSpan = parentSpan.traceChild(\"babel-turbo-get-config\");\n  const babelConfig = _getconfig.default.call(this, {\n    source,\n    loaderOptions,\n    inputSourceMap,\n    target,\n    filename\n  });\n  getConfigSpan.stop();\n  const normalizeSpan = parentSpan.traceChild(\"babel-turbo-normalize-file\");\n  const file = (0, _util.consumeIterator)((0, _corelibnormalizefile.default)(babelConfig.passes, (0, _corelibnormalizeopts.default)(babelConfig), source));\n  normalizeSpan.stop();\n  const transformSpan = parentSpan.traceChild(\"babel-turbo-transform\");\n  transformAst(file, babelConfig, transformSpan);\n  transformSpan.stop();\n  const generateSpan = parentSpan.traceChild(\"babel-turbo-generate\");\n  const {\n    code,\n    map\n  } = (0, _generator.default)(file.ast, file.opts.generatorOpts, file.code);\n  generateSpan.stop();\n  return {\n    code,\n    map\n  };\n}","map":{"version":3,"names":["transform","getTraversalParams","file","pluginPairs","passPairs","passes","visitors","plugin","concat","_corelibblockhoistplugin","default","pass","_corelibpluginpass","key","options","push","visitor","invokePluginPre","pre","call","invokePluginPost","post","transformAstPass","parentSpan","_traverse","merge","opts","wrapPluginVisitorMethod","traceChild","traceFn","ast","scope","transformAst","babelConfig","source","inputSourceMap","loaderOptions","filename","target","getConfigSpan","_getconfig","stop","normalizeSpan","_util","consumeIterator","_corelibnormalizefile","_corelibnormalizeopts","transformSpan","generateSpan","code","map","_generator","generatorOpts"],"sources":["../../../../src/build/babel/loader/transform.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}